clusterName: home-cluster
talosVersion: v1.0
kubernetesVersion: v1.23.6
cniConfig:
  name: flannel
  urls: []
endpoint: https://192.168.200.10:6443
allowSchedulingOnMasters: true
domain: cluster.localaaa
clusterPodNets:
  - 10.244.0.0/16
clusterSvcNets:
  - 10.96.0.0/12
nodes:
  - hostname: kmaster1
    ipAddress: 192.168.200.11
    installDisk: /dev/sda
    controlPlane: true
    nameservers:
      - 1.1.1.1
      - 8.8.8.8
    inlinePatch:
      machine:
        network:
          interfaces:
            - interface: eth0
              addresses:
                - 192.168.200.11/24
    configPatches:
      - op: add
        path: /cluster/apiServer/certSANs
        value:
          - 192.168.200.10
          - kmaster1
          - home-cluster.cluster.local
  - hostname: kmaster2
    ipAddress: 192.168.200.12
    installDisk: /dev/sda
    controlPlane: true
    networkInterfaces:
      - interface: eth0
        dhcp: true
        ignore: false
      - interface: eth1
        addresses:
          - 192.168.200.12/24
        mtu: 1500
  - hostname: kworker1
    ipAddress: 192.168.200.13
    installDisk: /dev/sdb
    controlPlane: false
controlPlane:
  configPatches:
    - op: add
      path: /machine/kubelet/extraArgs
      value:
        rotate-server-certificates: "true"
        feature-gates: GracefulNodeShutdown=true,MixedProtocolLBService=true
    - op: add
      path: /machine/install/extraKernelArgs
      value:
        - "talos.logging.kernel=udp://10.45.0.2:6050/"
worker:
  configPatches:
    - op: add
      path: /machine/kubelet/extraArgs
      value:
        rotate-server-certificates: "true"
        feature-gates: GracefulNodeShutdown=true,MixedProtocolLBService=true
